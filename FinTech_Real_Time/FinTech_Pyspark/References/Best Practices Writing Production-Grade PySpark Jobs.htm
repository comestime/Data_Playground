<!DOCTYPE html>
<!-- saved from url=(0090)https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Best Practices Writing Production-Grade PySpark Jobs</title><link rel="canonical" href="https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f"><meta name="title" content="Best Practices Writing Production-Grade PySpark Jobs"><meta name="referrer" content="always"><meta name="description" content="Using PySpark to process large amounts of data in a distributed fashion is a great way to manage large-scale data-heavy tasks and gain business insights while not sacrificing on developer efficiency…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Best Practices Writing Production-Grade PySpark Jobs"><meta property="og:url" content="https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*d3-v-8IrgJJHaKefzo3eXA.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="How to Structure Your PySpark Job Repository and Code"><meta name="twitter:description" content="How to Structure Your PySpark Job Repository and Code"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*d3-v-8IrgJJHaKefzo3eXA.jpeg"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://developerzen.com/@ekampf"><meta property="author" content="Eran Kampf"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/ekampf"><meta property="article:author" content="10153829056591494"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-01-24T18:07:53.616Z"><meta name="twitter:creator" content="@ekampf"><meta name="twitter:site" content="@ekampf"><meta property="og:site_name" content="DeveloperZen"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="7 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/cb688ac4d20f"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/cb688ac4d20f"><meta property="al:android:url" content="medium://p/cb688ac4d20f"><meta property="al:web:url" content="https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://developerzen.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/cb688ac4d20f"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1500,"height":809,"url":"https://cdn-images-1.medium.com/max/2000/1*d3-v-8IrgJJHaKefzo3eXA.jpeg"},"datePublished":"2017-01-24T18:07:53.616Z","dateModified":"2017-09-07T20:21:24.910Z","headline":"Best Practices Writing Production-Grade PySpark Jobs","name":"Best Practices Writing Production-Grade PySpark Jobs","keywords":["Python","Apache Spark","Machine Learning","Programming","Software Development"],"author":{"@type":"Person","name":"Eran Kampf","url":"https://developerzen.com/@ekampf"},"creator":["Eran Kampf"],"publisher":{"@type":"Organization","name":"DeveloperZen","url":"https://developerzen.com","logo":{"@type":"ImageObject","width":387,"height":57,"url":"https://cdn-images-1.medium.com/max/774/1*0VW1-pnCJTT6h10pfaBgHQ.png"}},"mainEntityOfPage":"https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f"}</script><link rel="stylesheet" type="text/css" href="./Best Practices Writing Production-Grade PySpark Jobs_files/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"><link rel="stylesheet" href="./Best Practices Writing Production-Grade PySpark Jobs_files/main-branding-base.rw_mbfQAC8iOAQEw0gm8Yg.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");ga("create", "UA-209163-4", "auto", 'tracker0'); ga("tracker0.send", "pageview");</script><script async="" src="./Best Practices Writing Production-Grade PySpark Jobs_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*Uws0y2pBZSsJsoMaHD2JqA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*Uws0y2pBZSsJsoMaHD2JqA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*Uws0y2pBZSsJsoMaHD2JqA.png"><link rel="apple-touch-icon" sizes="60x60" href="./Best Practices Writing Production-Grade PySpark Jobs_files/1-Uws0y2pBZSsJsoMaHD2JqA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlines is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1505091781976" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1280" height="632"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar u-boxShadowBottomThinLighter u-textColorDarker u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth u-tintBgColor u-tintSpectrum"><div class="metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-paddingLeft20 u-paddingRight20 u-height65 js-metabarMiddle"><div class="metabar-block u-flex1 u-flexCenter"><div class="js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-textColorDarker"><svg class="svgIcon-use" width="45" height="45" viewBox="0 0 45 45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-marginRight18"><div class="u-alignBlock"><a class="js-collectionLogoOrName" href="https://developerzen.com/?source=logo-lo_71fae15c7cc6---d186b3e1d814"><img height="36" width="244" class="u-paddingTop5" src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-0VW1-pnCJTT6h10pfaBgHQ.png" alt="DeveloperZen"></a></div></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-xs-hide"><div class="u-alignBlock"><div class="buttonSet u-lineHeightInherit u-marginLeft0"><div class="buttonSet-inner"><button class="button button--primary u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton is-smallPill" data-action="sign-in-prompt" data-sign-in-action="toggle-follow-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/developerzen" data-collection-id="d186b3e1d814"><span class="button-label  js-buttonLabel">Follow</span></button></div><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon" href="https://twitter.com/ekampf" title="Visit “DeveloperZen” on Twitter" aria-label="Visit “DeveloperZen” on Twitter" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-paddingLeft0" href="https://facebook.com/ekampf" title="Visit “DeveloperZen” on Facebook" aria-label="Visit “DeveloperZen” on Facebook" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21 12.646C21 7.65 16.97 3.6 12 3.6s-9 4.05-9 9.046a9.026 9.026 0 0 0 7.59 8.924v-6.376H8.395V12.64h2.193v-1.88c0-2.186 1.328-3.375 3.267-3.375.93 0 1.728.07 1.96.1V9.77H14.47c-1.055 0-1.26.503-1.26 1.242v1.63h2.517l-.33 2.554H13.21V21.6c4.398-.597 7.79-4.373 7.79-8.954"></path></svg></span></span></a></div></div></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56"><div class="u-alignBlock"><div class="buttonSet u-lineHeightInherit u-block u-margin0"><a class="button button--primary button--dark button--chromeless u-accentColor--buttonDark is-inSiteNavBar u-lineHeight30 u-height32" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fdeveloperzen.com%2Fbest-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f" data-action="sign-in-prompt" data-redirect="https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f" data-action-source="nav_signup">Sign in / Sign up</a></div></div></div></div><div class="u-absolute u-sizeFullWidth u-top0 u-right0 u-textAlignCenter js-metabarLogoCentered u-hide"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-textColorDarker"><svg class="svgIcon-use" width="45" height="45" viewBox="0 0 45 45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-tintBgColor u-height65 u-xs-height56"></div><main role="main"><article class=" u-sizeViewHeightMin100 u-overflowHidden postArticle postArticle--full is-withAccentColors u-marginBottom40" lang="en" data-scroll="native"><header class="container u-maxWidth740"><div class="postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="postMetaLockup postMetaLockup--authorWithBio u-flex js-postMetaLockup"><div class="u-flex0"><a class="link avatar u-baseColor--link" href="https://developerzen.com/@ekampf?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Eran Kampf"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><a class="link link link--darken link--darker u-baseColor--link" href="https://developerzen.com/@ekampf?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto">Eran Kampf</a><span class="followState js-followState buttonSet-inner" data-user-id="df73cbdf7d31"><button class="button u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/df73cbdf7d31" data-action-source="post_header_lockup_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span><div class="postMetaInline u-noWrapWithEllipsis u-xs-normalWrap u-xs-lineClamp2 u-xs-maxHeight2LineHeightBase">Maker of things. Big data geek. Onavo, Snaptu, WIX, WonderMall, Labgoo … Founder and CTO of dapulse.com and fiddme.</div><div class="postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2017-01-24T18:07:53.616Z">Jan 24</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="7 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="cb688ac4d20f" data-source="post_page" data-collection-id="d186b3e1d814" data-tracking-context="postPage" data-scroll="native"><section name="b025" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="e584" id="e584" class="graf graf--h3 graf--leading graf--title">Best Practices Writing Production-Grade PySpark&nbsp;Jobs</h1><h2 name="cc3b" id="cc3b" class="graf graf--h4 graf-after--h3 graf--subtitle">How to Structure Your PySpark Job Repository and&nbsp;Code</h2><figure name="68bd" id="68bd" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 378px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.900000000000006%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*d3-v-8IrgJJHaKefzo3eXA.jpeg" data-width="1500" data-height="809" data-action="zoom" data-action-value="1*d3-v-8IrgJJHaKefzo3eXA.jpeg" data-scroll="native"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-d3-v-8IrgJJHaKefzo3eXA.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="40"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*d3-v-8IrgJJHaKefzo3eXA.jpeg" src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-d3-v-8IrgJJHaKefzo3eXA(1).jpeg"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*d3-v-8IrgJJHaKefzo3eXA.jpeg"&gt;</noscript></div></div></figure><p name="941c" id="941c" class="graf graf--p graf-after--figure">Using PySpark to process large amounts of data in a distributed fashion is a great way to manage large-scale data-heavy tasks and gain business insights while not sacrificing on developer efficiency.</p><p name="5a14" id="5a14" class="graf graf--p graf-after--p">In short, <a href="http://spark.apache.org/docs/latest/api/python/" data-href="http://spark.apache.org/docs/latest/api/python/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">PySpark</a> is awesome.<br>However, while there are a lot of code examples out there, there’s isn’t a lot of information out there (that I could find) on how to build a PySpark codebase— writing modular jobs, building, packaging, handling dependencies, testing, etc. — that could scale to a larger development team.</p><p name="ace8" id="ace8" class="graf graf--p graf-after--p">So, following a year+ working with PySpark I decided to collect all the know-hows and conventions we’ve gathered into this post (and accompanying <a href="https://github.com/ekampf/PySpark-Boilerplate" data-href="https://github.com/ekampf/PySpark-Boilerplate" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">boilerplate project</a>)</p><p name="1942" id="1942" class="graf graf--p graf-after--p">In this post we’ll cover:</p><ul class="postList"><li name="c1c9" id="c1c9" class="graf graf--li graf-after--p">Structuring PySpark Jobs</li><li name="eafd" id="eafd" class="graf graf--li graf-after--li">Handling 3rd-party dependencies</li><li name="f7f7" id="f7f7" class="graf graf--li graf-after--li">Writing a PySpark Job</li><li name="9f1f" id="9f1f" class="graf graf--li graf-after--li">Unit Testing</li></ul><h3 name="d198" id="d198" class="graf graf--h3 graf-after--li">Structuring our Jobs Repository</h3><p name="4e2f" id="4e2f" class="graf graf--p graf-after--h3">First, let’s go over how submitting a job to PySpark works:<br><code class="markup--code markup--p-code">spark-submit --py-files pyfile.py,zipfile.zip main.py --arg1 val1</code></p><p name="5db1" id="5db1" class="graf graf--p graf-after--p">When we submit a job to PySpark we submit the main Python file to run — <code class="markup--code markup--p-code">main.py</code> — and we can also add a list of dependent files that will be located together with our main file during execution.<br>These dependency files can be&nbsp;<em class="markup--em markup--p-em">.py</em> code files we can import from, but can also be any other kind of files. For example,&nbsp;<em class="markup--em markup--p-em">.zip</em> packages.</p><p name="b6b4" id="b6b4" class="graf graf--p graf-after--p">One of the cool features in Python is that it can treat a <em class="markup--em markup--p-em">zip</em> file as a directory as import modules and functions from just as any other directory.&nbsp;<br>All that is needed is to add the <em class="markup--em markup--p-em">zip</em> file to its search path.</p><pre name="b80f" id="b80f" class="graf graf--pre graf-after--p">import sys<br>sys.path.insert(0, jobs.zip)</pre><p name="4656" id="4656" class="graf graf--p graf-after--pre">now (assuming <em class="markup--em markup--p-em">jobs.zip</em> contains a python module called <em class="markup--em markup--p-em">jobs</em>) we can import that module and whatever that’s in it. For example:</p><pre name="f90d" id="f90d" class="graf graf--pre graf-after--p">from jobs.wordcount import run_job<br>run_job()</pre><p name="1262" id="1262" class="graf graf--p graf-after--pre">This will allow us to build our PySpark job like we’d build any Python project — using multiple modules and files — rather than one bigass <em class="markup--em markup--p-em">myjob.py</em> (or several such files)</p><p name="c2c9" id="c2c9" class="graf graf--p graf-after--p">Armed with this knowledge let’s structure out PySpark project…</p><h4 name="612c" id="612c" class="graf graf--h4 graf-after--p">Jobs as&nbsp;Modules</h4><p name="d1d4" id="d1d4" class="graf graf--p graf-after--h4">We’ll define each job as a Python module where it can define its code and transformation in whatever way it likes (multiple files, multiple sub modules…).</p><pre name="fafc" id="fafc" class="graf graf--pre graf-after--p">.<br>├── README.md<br>├── src<br>│   ├── main.py<br>│   ├── jobs<br>│   │   └── wordcount<br>│   │       └── __init__.py</pre><p name="e425" id="e425" class="graf graf--p graf-after--pre">The job itself has to expose an <code class="markup--code markup--p-code">analyze</code> function:</p><pre name="61c5" id="61c5" class="graf graf--pre graf-after--p">def analyze(sc, **kwargs):<br>   ...</pre><p name="f4ce" id="f4ce" class="graf graf--p graf-after--pre">and a <code class="markup--code markup--p-code">main.py</code> which is the entry point to our job — it parses command line arguments and dynamically loads the requested job module and runs it:</p><pre name="717a" id="717a" class="graf graf--pre graf-after--p">import pyspark</pre><pre name="a922" id="a922" class="graf graf--pre graf-after--pre">if os.path.exists('jobs.zip'):<br>    sys.path.insert(0, 'jobs.zip')<br>else:<br>    sys.path.insert(0, './jobs')</pre><pre name="996d" id="996d" class="graf graf--pre graf-after--pre">parser = argparse.ArgumentParser()<br>parser.add_argument('--job', type=str, required=True)<br>parser.add_argument('--job-args', nargs='*')<br>args = parser.parse_args()</pre><pre name="9d28" id="9d28" class="graf graf--pre graf-after--pre">sc = pyspark.SparkContext(appName=args.job_name)<br>job_module = importlib.import_module('jobs.%s' % args.job)<br>job_module.analyze(sc, job_args)</pre><p name="9d38" id="9d38" class="graf graf--p graf-after--pre">To run this job on Spark we’ll need to package it so we can submit it via <code class="markup--code markup--p-code">spark-submit</code>&nbsp;…</p><h3 name="5ce2" id="5ce2" class="graf graf--h3 graf-after--p">Packaging</h3><p name="89aa" id="89aa" class="graf graf--p graf-after--h3">As we previously showed, when we submit the job to Spark we want to submit <code class="markup--code markup--p-code">main.py</code> as our job file and the rest of the code as a <code class="markup--code markup--p-code">--py-files</code> extra dependency <code class="markup--code markup--p-code">jobs.zip</code>file.<br>So, out packaging script (we’ll add it as a command to our <code class="markup--code markup--p-code">Makefile</code>) is:</p><pre name="0cc6" id="0cc6" class="graf graf--pre graf-after--p">build:<br>    mkdir ./dist<br>    cp ./src/main.py ./dist<br>    cd ./src &amp;&amp; zip -x main.py -r ../dist/jobs.zip .</pre><p name="b0ad" id="b0ad" class="graf graf--p graf-after--pre">Now we can submit our job to Spark:</p><pre name="acaa" id="acaa" class="graf graf--pre graf-after--p">make build<br>cd dist &amp;&amp; spark-submit --py-files jobs.zip main.py --job wordcount</pre><p name="68f8" id="68f8" class="graf graf--p graf-after--pre">If you noticed before, out <code class="markup--code markup--p-code">main.py</code> code runs&nbsp;<br><code class="markup--code markup--p-code">sys.path.insert(0, 'jobs.zip)</code><br>making all the modules inside it available for import.<br>Right now we only have one such module we need to import — <code class="markup--code markup--p-code">jobs</code> — which contains our job logic.</p><p name="fd96" id="fd96" class="graf graf--p graf-after--p">We can also add a <code class="markup--code markup--p-code">shared</code> module for writing logic that is used by multiple jobs. That module we’ll simply get zipped into <code class="markup--code markup--p-code">jobs.zip</code> too and become available for import.</p><pre name="556f" id="556f" class="graf graf--pre graf-after--p">.<br>├── Makefile<br>├── README.md<br>├── src<br>│   ├── main.py<br>│   ├── jobs<br>│   │   └── wordcount<br>│   │       └── __init__.py<br>│   └── shared<br>│       └── __init__.py</pre><h4 name="01b4" id="01b4" class="graf graf--h4 graf-after--pre">Handling 3rd Party Dependencies</h4><p name="aaa9" id="aaa9" class="graf graf--p graf-after--h4">One of the requirements anyone who’s writing a job bigger the the “hello world” probably needs to depend on some external python pip packages.</p><p name="d80c" id="d80c" class="graf graf--p graf-after--p">To use external libraries, we’ll simply have to pack their code and ship it to spark the same way we pack and ship our jobs code.&nbsp;<br><code class="markup--code markup--p-code">pip</code> allows installing dependencies into a folder using its <code class="markup--code markup--p-code">-t&nbsp;./some_folder</code> options.</p><p name="bd51" id="bd51" class="graf graf--p graf-after--p">The same way we defined the <code class="markup--code markup--p-code">shared</code> module we can simply install all our dependencies into the <code class="markup--code markup--p-code">src</code> folder and they’ll be packages and be available for import the same way our <code class="markup--code markup--p-code">jobs</code> and <code class="markup--code markup--p-code">shared</code> modules are:</p><pre name="db6b" id="db6b" class="graf graf--pre graf-after--p">pip install -r requirements.txt -t ./src</pre><p name="a22a" id="a22a" class="graf graf--p graf-after--pre">However, this will create an ugly folder structure where all our requirement’s code will sit in source, overshadowing the 2 modules we <em class="markup--em markup--p-em">really</em> care about: <code class="markup--code markup--p-code">shared</code> and <code class="markup--code markup--p-code">jobs</code></p><p name="c0bb" id="c0bb" class="graf graf--p graf-after--p">That’s why I find it useful to add a special folder — <code class="markup--code markup--p-code">libs</code> — where I install requirements to:</p><pre name="0ada" id="0ada" class="graf graf--pre graf-after--p">.<br>├── Makefile<br>├── README.md<br>├── requirements.txt<br>├── src<br>│   ├── main.py<br>│   ├── jobs<br>│   │   └── wordcount<br>│   │       └── __init__.py<br><strong class="markup--strong markup--pre-strong">│   └── libs<br>│   │   └── requests<br>│   │   └── ...</strong><br>│   └── shared<br>│       └── __init__.py</pre><p name="1106" id="1106" class="graf graf--p graf-after--pre">With our current packaging system will break imports as <code class="markup--code markup--p-code">import some_package</code> will now have to be written as <code class="markup--code markup--p-code">import libs.some_package.<br></code>To solve that we’ll simply package our <code class="markup--code markup--p-code">libs</code> folder into a separate zip package who’s root older is <code class="markup--code markup--p-code">libs</code>.</p><pre name="9374" id="9374" class="graf graf--pre graf-after--p">build: clean<br> mkdir ./dist<br> cp ./src/main.py ./dist<br> cd ./src &amp;&amp; zip -x main.py -x \*libs\* -r ../dist/jobs.zip .<br> cd ./src/libs &amp;&amp; zip -r ../../dist/libs.zip .</pre><p name="9fb5" id="9fb5" class="graf graf--p graf-after--pre">Now we can import our 3rd party dependencies without a <code class="markup--code markup--p-code">libs.</code> prefix, and run our job on PySpark using:</p><pre name="44fb" id="44fb" class="graf graf--pre graf-after--p">cd dist<br>spark-submit --py-files jobs.zip,libs.zip main.py --job wordcount</pre><p name="dd25" id="dd25" class="graf graf--p graf-after--pre">The only caveat with this approach is that it can only work for pure-Python dependencies. For libraries that require C++ compilation, there’s no other choice but to make sure they’re pre-installed on all nodes before the job runs which is a bit harder to manage. Fortunately, most libraries do not require compilation which makes most dependencies easy to manage,</p><h3 name="0ed1" id="0ed1" class="graf graf--h3 graf-after--p">Writing a PySpark&nbsp;Job</h3><p name="327c" id="327c" class="graf graf--p graf-after--h3">The next section is how to write a jobs’s code so that it’s nice, tidy and easy to test.</p><h4 name="e03b" id="e03b" class="graf graf--h4 graf-after--p">Providing a Shared&nbsp;Context</h4><p name="6cfe" id="6cfe" class="graf graf--p graf-after--h4">When writing a job, there’s usually some sort of global context we want to make available to the different transformation functions.&nbsp;<br>Spark <em class="markup--em markup--p-em">broadcast variables, counters,</em> and misc configuration data coming from command-line are the common examples for such job context data.</p><p name="6ae8" id="6ae8" class="graf graf--p graf-after--p">For this case we’ll define a <code class="markup--code markup--p-code">JobContext</code> class that handles all our <em class="markup--em markup--p-em">broadcast variables</em> and counters:</p><pre name="4c88" id="4c88" class="graf graf--pre graf-after--p">from collections import OrderedDict<br>from tabulate import tabulate</pre><pre name="d44d" id="d44d" class="graf graf--pre graf-after--pre">class JobContext(object):<br>  def __init__(self, sc):<br>    self.counters = OrderedDict()<br>    self._init_accumulators(sc)<br>    self._init_shared_data(sc)</pre><pre name="d41e" id="d41e" class="graf graf--pre graf-after--pre">  def _init_accumulators(self, sc):<br>    pass</pre><pre name="64a1" id="64a1" class="graf graf--pre graf-after--pre">  def _init_shared_data(self, sc):<br>    pass</pre><pre name="1abf" id="1abf" class="graf graf--pre graf-after--pre">  def initalize_counter(self, sc, name):<br>    self.counters[name] = sc.accumulator(0)</pre><pre name="2f68" id="2f68" class="graf graf--pre graf-after--pre">  def inc_counter(self, name, value=1):<br>    if name not in self.counters:<br>      raise ValueError("%s counter was not initialized. (%s)" % (name, self.counters.keys()))</pre><pre name="c115" id="c115" class="graf graf--pre graf-after--pre">    self.counters[name] += value</pre><pre name="0f09" id="0f09" class="graf graf--pre graf-after--pre">  def print_accumulators(self):<br>    print 'aa\n' * 2<br>    print tabulate(self.counters.items(), <br>                   self.counters.keys(), <br>                   tablefmt="simple")</pre><p name="2984" id="2984" class="graf graf--p graf-after--pre">We’ll create an instance of it on our job’s code and pass it to our transformations.<br>For example, let’s say we want to test the number of words on our wordcount job:</p><pre name="212d" id="212d" class="graf graf--pre graf-after--p">class WordCountJobContext(JobContext):<br>  def _init_accumulators(self, sc):<br>    self.initalize_counter(sc, 'words')</pre><pre name="1231" id="1231" class="graf graf--pre graf-after--pre">def to_pairs(context, word):<br>  <strong class="markup--strong markup--pre-strong">context.inc_counter('words')</strong><br>  return word, 1</pre><pre name="e801" id="e801" class="graf graf--pre graf-after--pre">def analyze(sc):<br>  print "Running wordcount"<br>  <strong class="markup--strong markup--pre-strong">context = WordCountJobContext(sc)</strong><br>  text = " ...  some text ..."</pre><pre name="f6f1" id="f6f1" class="graf graf--pre graf-after--pre">  words = sc.parallelize(text.split())<br>  pairs = words.map(<strong class="markup--strong markup--pre-strong">lambda word: to_pairs(context, word)</strong>)<br>  ordered = counts.sortBy(lambda pair: pair[1], ascending=False)<br>  print ordered.collect()<br>  context.print_accumulators()</pre><p name="0ade" id="0ade" class="graf graf--p graf-after--pre">Besides sorting the words by occurrence, we’ll now also keep a distributed counter on our context that counts the number of words we processed in total. We can then nicely print it at the end by calling `context.print_accumulators()` or access it via <code class="markup--code markup--p-code">context.counters['words']</code></p><h4 name="0679" id="0679" class="graf graf--h4 graf-after--p">Writing Transformations</h4><p name="6f16" id="6f16" class="graf graf--p graf-after--h4">The code above is pretty cumbersome to write instead of simple transformations that look like <code class="markup--code markup--p-code">pairs = words.map(to_pairs)</code> we now have this extra context parameter requiring us to write a lambda expression: <code class="markup--code markup--p-code">pairs = words.map(lambda word: to_pairs(context, word)</code></p><p name="992f" id="992f" class="graf graf--p graf-after--p">So we’ll use <a href="https://docs.python.org/2/library/functools.html#functools.partial" data-href="https://docs.python.org/2/library/functools.html#functools.partial" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">functools.partial</em></a><em class="markup--em markup--p-em"> </em>to make our code nicer:</p><pre name="387e" id="387e" class="graf graf--pre graf-after--p">def analyze(sc):<br>  print "Running wordcount"<br>  <strong class="markup--strong markup--pre-strong">context = WordCountJobContext(sc)</strong><br>  text = " ...  some text ..."</pre><pre name="dd45" id="dd45" class="graf graf--pre graf-after--pre">  <strong class="markup--strong markup--pre-strong">to_pairs_step = partial(to_pairs, context)</strong></pre><pre name="aceb" id="aceb" class="graf graf--pre graf-after--pre">  words = sc.parallelize(text.split())<br>  pairs = words.map(<strong class="markup--strong markup--pre-strong">to_pairs_step</strong>)<br>  ordered = counts.sortBy(lambda pair: pair[1], ascending=False)<br>  print ordered.collect()<br>  context.print_accumulators()</pre><h3 name="5cbe" id="5cbe" class="graf graf--h3 graf-after--pre">Unit Testing</h3><p name="410c" id="410c" class="graf graf--p graf-after--h3">When looking at PySpark ode, there are few ways we can (should) test our code:</p><p name="4067" id="4067" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Transformation Tests</strong> — since transformations (like our <code class="markup--code markup--p-code">to_pairs</code> above) are just regular Python functions, we can simply test them the same way we’d test any other python Function</p><pre name="7887" id="7887" class="graf graf--pre graf-after--p">from mock import MagicMock<br>from jobs.wordcount import to_pairs</pre><pre name="6b4f" id="6b4f" class="graf graf--pre graf-after--pre">def test_to_pairs():<br>  context_mock = MagicMock()<br>  result = to_pairs(context_mock, 'foo')<br>  assert result[0] == 'foo'<br>  assert result[1] == 1<br>  context_mock.inc_counter.assert_called_with('words')</pre><p name="ef8f" id="ef8f" class="graf graf--p graf-after--pre">These tests cover 99% of our code, so if we just test our transformations we’re mostly covered.</p><p name="b4f2" id="b4f2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Entire Flow Tests — </strong>testing the entire PySpark flow is a bit tricky because Spark runs in JAVA and as a separate process.<br>The best way to test the flow is to <em class="markup--em markup--p-em">fake</em> the spark functionality.<br>The <a href="https://github.com/svenkreiss/pysparkling" data-href="https://github.com/svenkreiss/pysparkling" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">PySparking</a> is a pure-Python implementation of the PySpark RDD interface.&nbsp;<br>It acts like a real Spark cluster would, but implemented Python so we can simple send our job’s <code class="markup--code markup--p-code">analyze</code> function a <code class="markup--code markup--p-code">pysparking.Context</code>instead of the real <code class="markup--code markup--p-code">SparkContext</code> to make our job run the same way it would run in Spark.<br>Since we’re running on pure Python we can easily mock things like external http requests, DB access etc. which is necessary for writing good unit tests.</p><pre name="02c0" id="02c0" class="graf graf--pre graf-after--p">import pysparkling<br>from mock import patch<br>from jobs.wordcount import analyze</pre><pre name="bd34" id="bd34" class="graf graf--pre graf-after--pre">@patch('jobs.wordcount.get_text')<br>def test_wordcount(get_text_mock):<br>  get_text_mock.return_value = "foo bar foo"<br>  sc = pysparkling.Context()<br>  result = analyze(sc)<br>  assert result[0] == ('foo', 2)<br>  assert result[1] == ('bar', 1)</pre><p name="74a9" id="74a9" class="graf graf--p graf-after--pre">Testing the entire job flow requires refactoring the job’s code a bit so that <code class="markup--code markup--p-code">analyze</code> returns a value to be tested and that the input is configurable so that we could mock it.</p><h3 name="9885" id="9885" class="graf graf--h3 graf-after--p">Where to go from&nbsp;here…</h3><p name="fdae" id="fdae" class="graf graf--p graf-after--h3 graf--trailing">You can find the full source code for a PySpark starter boilerplate implementing the concepts described above on <a href="https://github.com/ekampf/PySpark-Boilerplate" data-href="https://github.com/ekampf/PySpark-Boilerplate" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://github.com/ekampf/PySpark-Boilerplate</a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://developerzen.com/tagged/python?source=post" data-action-source="post" data-collection-slug="developerzen">Python</a></li><li><a class="link u-baseColor--link" href="https://developerzen.com/tagged/apache-spark?source=post" data-action-source="post" data-collection-slug="developerzen">Apache Spark</a></li><li><a class="link u-baseColor--link" href="https://developerzen.com/tagged/machine-learning?source=post" data-action-source="post" data-collection-slug="developerzen">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://developerzen.com/tagged/programming?source=post" data-action-source="post" data-collection-slug="developerzen">Programming</a></li><li><a class="link u-baseColor--link" href="https://developerzen.com/tagged/software-development?source=post" data-action-source="post" data-collection-slug="developerzen">Software Development</a></li></ul></div></div></div><section class="u-paddingTop20 u-borderTopLightest u-marginTop10"><div class="u-textColorDarker u-fontSize22 u-marginBottom7">Show your support</div><p class="u-textColorDark u-fontSize16">Clapping shows how much you appreciated Eran Kampf’s story.</p></section><div class="postActions u-flexCenter js-postActionsFooter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="cb688ac4d20f" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/cb688ac4d20f" data-action-source="post_actions_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="cb688ac4d20f"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="cb688ac4d20f">58</button></span></div></div><div class="u-flex0 buttonSet buttonSet--narrow"><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">4</button></div><div class="buttonSet-inner u-xs-hide"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></div><div class="buttonSet-inner u-xs-hide"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></div></div></div></div><div class="js-postPromotionWrapper postPromotionWrapper" data-location-id="footer_above_post_attribution"></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop10 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState buttonSet-inner" data-user-id="df73cbdf7d31"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/df73cbdf7d31" data-action-source="footer_card_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell "><a class="link avatar u-baseColor--link" href="https://developerzen.com/@ekampf?source=footer_card" title="Go to the profile of Eran Kampf" aria-label="Go to the profile of Eran Kampf" data-action-source="footer_card" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Eran Kampf"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://developerzen.com/@ekampf" property="cc:attributionName" title="Go to the profile of Eran Kampf" aria-label="Go to the profile of Eran Kampf" rel="author cc:attributionUrl" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto">Eran Kampf</a></h3><p class="u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Maker of things. Big data geek. Onavo, Snaptu, WIX, WonderMall, Labgoo … Founder and CTO of dapulse.com and fiddme.</p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton" data-action="sign-in-prompt" data-sign-in-action="toggle-follow-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/developerzen" data-collection-id="d186b3e1d814"><span class="button-label  js-buttonLabel">Follow</span></button></div><div class="u-tableCell "><a class="link avatar avatar--roundedRectangle u-baseColor--link" href="https://developerzen.com/?source=footer_card" title="Go to DeveloperZen" aria-label="Go to DeveloperZen" data-action-source="footer_card" data-collection-slug="developerzen"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-Uws0y2pBZSsJsoMaHD2JqA.png" class="avatar-image u-size60x60" alt="DeveloperZen"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://developerzen.com/?source=footer_card" rel="collection" data-action-source="footer_card" data-collection-slug="developerzen">DeveloperZen</a></h3><p class="u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">The essence of Software Development …</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements" data-action-scope="_actionscope_14"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="d359ece3117b" data-source="placement_card_footer_grid---------0-41" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://developerzen.com/5-tips-for-choosing-your-startups-technology-stack-d359ece3117b?source=placement_card_footer_grid---------0-41" data-action-source="placement_card_footer_grid---------0-41"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*q0FLnWXGGDsn2dNLRgj8Og.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://developerzen.com/5-tips-for-choosing-your-startups-technology-stack-d359ece3117b?source=placement_card_footer_grid---------0-41" data-action-source="placement_card_footer_grid---------0-41"><div class="postMetaInline u-marginBottom7">More from DeveloperZen</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">5 Tips for Choosing Your Startup’s Technology Stack</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://developerzen.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp(1).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Eran Kampf"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://developerzen.com/@ekampf?source=placement_card_footer_grid---------0-41" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-41" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" data-collection-slug="developerzen" dir="auto">Eran Kampf</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="d359ece3117b" data-is-label-padded="true" data-is-compressed="true" data-source="placement_card_footer_grid---------0-41"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/d359ece3117b" data-action-source="placement_card_footer_grid---------0-41" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="d359ece3117b">12</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/d359ece3117b"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="e806ba55a81f" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.freecodecamp.org/which-languages-should-you-learn-for-data-science-e806ba55a81f?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*gSxUa9oNaBk1QJf6eqQYeg.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://medium.freecodecamp.org/which-languages-should-you-learn-for-data-science-e806ba55a81f?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="postMetaInline u-marginBottom7">Also tagged Programming</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Which Languages Should You Learn For Data Science?</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.freecodecamp.org/@petergleeson1" data-action="show-user-card" data-action-value="536515a4b25d" data-action-type="hover" data-user-id="536515a4b25d" data-collection-slug="free-code-camp" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-jYH_43uKbwiZhfXddHE1BQ.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Peter Gleeson"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.freecodecamp.org/@petergleeson1?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="536515a4b25d" data-action-type="hover" data-user-id="536515a4b25d" data-collection-slug="free-code-camp" dir="auto">Peter Gleeson</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="12 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="e806ba55a81f" data-is-label-padded="true" data-is-compressed="true" data-source="placement_card_footer_grid---------1-43"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/e806ba55a81f" data-action-source="placement_card_footer_grid---------1-43" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="e806ba55a81f">3.9K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/e806ba55a81f"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="ab99f4830c2d" data-source="placement_card_footer_grid---------2-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://hackernoon.com/engineers-dont-ever-take-the-first-offer-ab99f4830c2d?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*5p3l2tLLRB-VXZo_Dlzv3Q.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://hackernoon.com/engineers-dont-ever-take-the-first-offer-ab99f4830c2d?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="postMetaInline u-marginBottom7">Also tagged Software Development</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Engineers, Don’t Ever Take The First Offer</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://hackernoon.com/@rudyrigot" data-action="show-user-card" data-action-value="6fc99168b3fe" data-action-type="hover" data-user-id="6fc99168b3fe" data-collection-slug="hacker-daily" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-uT222MHuv7tsJoEb.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Rudy Rigot"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://hackernoon.com/@rudyrigot?source=placement_card_footer_grid---------2-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-43" data-action-value="6fc99168b3fe" data-action-type="hover" data-user-id="6fc99168b3fe" data-collection-slug="hacker-daily" dir="auto">Rudy Rigot</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="5 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="ab99f4830c2d" data-is-label-padded="true" data-is-compressed="true" data-source="placement_card_footer_grid---------2-43"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/ab99f4830c2d" data-action-source="placement_card_footer_grid---------2-43" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="ab99f4830c2d">267</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/ab99f4830c2d"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading u-clearfix"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom30 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-in-prompt" data-redirect="https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f#--respond" data-skip-onboarding="true" data-action-source="logged_out_response_prompt"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div><div class="responsesStream js-responsesStream"><div class="streamItem streamItem--conversation js-streamItem" data-action-scope="_actionscope_6"><div class="streamItemConversation"><div class="u-marginLeft20"><div class="streamItemConversation-divider"></div><header class="heading u-clearfix heading--light heading--simple"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">Conversation between <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@ktal90" data-action="show-user-card" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto">Karan Talati</a> and <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a>.</span></div></div></header></div><div class="streamItemConversation-inner cardChromeless"><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackedPost postArticle--short" data-post-id="82bd452d7f83" data-source="responses---------0----------------" data-action-scope="_actionscope_7" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@ktal90" data-action="show-user-card" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-j-w1FWiz8WJ9c2h_21gkuA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Karan Talati"><div class="avatar-halo u-absolute u-tintSpectrum u-accentColor--iconNormal u-textColorGreenNormal svgIcon" style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"><svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M3.44615311,11.6601601 C6.57294867,5.47967718 12.9131553,1.5 19.9642857,1.5 C27.0154162,1.5 33.3556228,5.47967718 36.4824183,11.6601601 L37.3747245,11.2087295 C34.0793076,4.69494641 27.3961457,0.5 19.9642857,0.5 C12.5324257,0.5 5.84926381,4.69494641 2.55384689,11.2087295 L3.44615311,11.6601601 Z"></path><path d="M36.4824183,28.2564276 C33.3556228,34.4369105 27.0154162,38.4165876 19.9642857,38.4165876 C12.9131553,38.4165876 6.57294867,34.4369105 3.44615311,28.2564276 L2.55384689,28.7078582 C5.84926381,35.2216412 12.5324257,39.4165876 19.9642857,39.4165876 C27.3961457,39.4165876 34.0793076,35.2216412 37.3747245,28.7078582 L36.4824183,28.2564276 Z"></path></svg></div></div></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@ktal90?source=responses---------0----------------" data-action="show-user-card" data-action-source="responses---------0----------------" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto">Karan Talati</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@ktal90/nice-thanks-for-posting-this-82bd452d7f83?source=responses---------0----------------" data-action="open-post" data-action-value="https://medium.com/@ktal90/nice-thanks-for-posting-this-82bd452d7f83?source=responses---------0----------------" data-action-source="preview-listing"><time datetime="2017-01-30T23:48:30.034Z">Jan 30</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="1 min read"></span></div></div></div></div></div><div class="js-inlineExpandBody"><a class="" href="https://medium.com/@ktal90/nice-thanks-for-posting-this-82bd452d7f83?source=responses---------0----------------" data-action="expand-inline"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="90a5" id="90a5" class="graf graf--p graf--leading graf--trailing">Nice! Thanks for posting this. As you mentioned, the community is lacking content on best practices, project structure, etc. I find your jobs-as-modules paradigm a great solution to this problem, and I think I might try to incorporate this for a large Spark project we have.</p></div></div></section></div></a></div><div class="postArticle-readMore"><button class="button button--smaller button--link u-baseColor--buttonNormal" data-action="expand-inline">Read more…</button></div><div class="u-clearfix u-paddingTop10"><div class="buttonSet buttonSet--withLabels u-floatLeft"><div class="buttonSet-inner"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="82bd452d7f83" data-is-flush-left="true" data-is-compressed="true" data-source="listing"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/82bd452d7f83" data-action-source="listing" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="82bd452d7f83">3</button></span></div></div></div><div class="buttonSet u-floatRight"><div class="buttonSet-inner"><a class="button button--chromeless u-baseColor--buttonNormal" href="https://medium.com/@ktal90/nice-thanks-for-posting-this-82bd452d7f83?source=responses---------0----------------#--responses" data-action-source="responses---------0----------------">2 responses</a><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/82bd452d7f83"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackedPost postArticle--short" data-post-id="d5640b45bbb3" data-source="responses---------0----------------" data-action-scope="_actionscope_8" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp(1).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Eran Kampf"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@ekampf?source=responses---------0----------------" data-action="show-user-card" data-action-source="responses---------0----------------" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@ekampf/hey-karen-d5640b45bbb3?source=responses---------0----------------" data-action="open-post" data-action-value="https://medium.com/@ekampf/hey-karen-d5640b45bbb3?source=responses---------0----------------" data-action-source="preview-listing"><time datetime="2017-02-15T22:09:17.922Z">Feb 15</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="1 min read"></span></div></div></div></div></div><div class="js-inlineExpandBody"><a class="" href="https://medium.com/@ekampf/hey-karen-d5640b45bbb3?source=responses---------0----------------" data-action="expand-inline"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="3feb" id="3feb" class="graf graf--p graf--leading">Hey Karen,</p><p name="96d5" id="96d5" class="graf graf--p graf-after--p">Thanks for the response&nbsp;:)</p><p name="1321" id="1321" class="graf graf--p graf-after--p graf--trailing">Regarding your approach, what do you mean by “traditional python packaging”&nbsp;? if I understand correctly, you’re putting all your shared logic in a <em class="markup--em markup--p-em">pip</em> module which then you still need to <em class="markup--em markup--p-em">pip install -t</em> as I showed in my post.</p></div></div></section></div></a></div><div class="postArticle-readMore"><button class="button button--smaller button--link u-baseColor--buttonNormal" data-action="expand-inline">Read more…</button></div><div class="u-clearfix u-paddingTop10"><div class="buttonSet buttonSet--withLabels u-floatLeft"><div class="buttonSet-inner"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="d5640b45bbb3" data-is-flush-left="true" data-is-compressed="true" data-source="listing"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/d5640b45bbb3" data-action-source="listing" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="d5640b45bbb3">1</button></span></div></div></div><div class="buttonSet u-floatRight"><div class="buttonSet-inner"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/d5640b45bbb3"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div><div class="streamItem streamItem--conversation js-streamItem" data-action-scope="_actionscope_9"><div class="streamItemConversation"><div class="u-marginLeft20"><div class="streamItemConversation-divider"></div><header class="heading u-clearfix heading--light heading--simple"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">Conversation between <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@ktal90" data-action="show-user-card" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto">Karan Talati</a> and <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a>.</span></div></div></header></div><div class="streamItemConversation-inner cardChromeless"><div class="streamItemConversationItem streamItemConversationItem--summary"><span class="postMetaInline"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@ktal90" data-action="show-user-card" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-j-w1FWiz8WJ9c2h_21gkuA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Karan Talati"><div class="avatar-halo u-absolute u-tintSpectrum u-accentColor--iconNormal u-textColorGreenNormal svgIcon" style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"><svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M3.44615311,11.6601601 C6.57294867,5.47967718 12.9131553,1.5 19.9642857,1.5 C27.0154162,1.5 33.3556228,5.47967718 36.4824183,11.6601601 L37.3747245,11.2087295 C34.0793076,4.69494641 27.3961457,0.5 19.9642857,0.5 C12.5324257,0.5 5.84926381,4.69494641 2.55384689,11.2087295 L3.44615311,11.6601601 Z"></path><path d="M36.4824183,28.2564276 C33.3556228,34.4369105 27.0154162,38.4165876 19.9642857,38.4165876 C12.9131553,38.4165876 6.57294867,34.4369105 3.44615311,28.2564276 L2.55384689,28.7078582 C5.84926381,35.2216412 12.5324257,39.4165876 19.9642857,39.4165876 C27.3961457,39.4165876 34.0793076,35.2216412 37.3747245,28.7078582 L36.4824183,28.2564276 Z"></path></svg></div></div></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@ktal90" data-action="show-user-card" data-action-value="97697c5f82db" data-action-type="hover" data-user-id="97697c5f82db" dir="auto">Karan Talati</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental">Nice! Thanks for posting this. We take a different approach — everything that lives in the Python realm, we treat like any other Python module. We try to put as much…</div></div></div></span></div><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackedPost postArticle--short" data-post-id="81ad80053abe" data-source="responses---------1----------------" data-action-scope="_actionscope_10" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp(1).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Eran Kampf"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@ekampf?source=responses---------1----------------" data-action="show-user-card" data-action-source="responses---------1----------------" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@ekampf/hey-karan-thanks-for-the-kind-words-81ad80053abe?source=responses---------1----------------" data-action="open-post" data-action-value="https://medium.com/@ekampf/hey-karan-thanks-for-the-kind-words-81ad80053abe?source=responses---------1----------------" data-action-source="preview-listing"><time datetime="2017-08-16T17:36:15.645Z">Aug 16</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="1 min read"></span></div></div></div></div></div><div class="js-inlineExpandBody"><a class="" href="https://medium.com/@ekampf/hey-karan-thanks-for-the-kind-words-81ad80053abe?source=responses---------1----------------" data-action="expand-inline"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d618" id="d618" class="graf graf--p graf--leading">Hey Karan! Thanks for the kind words&nbsp;:)</p><p name="cf83" id="cf83" class="graf graf--p graf-after--p">Regarding the “shared” code problem you described — lets differentiate between 2 kinds of shared code.</p><p name="9eb9" id="9eb9" class="graf graf--p graf-after--p graf--trailing">The high-level shared code is one shared by many (or all) projects — not just Spark. This is the kind of code that belongs in its own separate pip library…</p></div></div></section></div></a></div><div class="postArticle-readMore"><button class="button button--smaller button--link u-baseColor--buttonNormal" data-action="expand-inline">Read more…</button></div><div class="u-clearfix u-paddingTop10"><div class="buttonSet buttonSet--withLabels u-floatLeft"><div class="buttonSet-inner"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="81ad80053abe" data-is-flush-left="true" data-is-compressed="true" data-source="listing"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/81ad80053abe" data-action-source="listing" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="81ad80053abe">1</button></span></div></div></div><div class="buttonSet u-floatRight"><div class="buttonSet-inner"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/81ad80053abe"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div><div class="streamItem streamItem--conversation js-streamItem" data-action-scope="_actionscope_11"><div class="streamItemConversation"><div class="u-marginLeft20"><div class="streamItemConversation-divider"></div><header class="heading u-clearfix heading--light heading--simple"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">Conversation with <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a>.</span></div></div></header></div><div class="streamItemConversation-inner cardChromeless"><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackedPost postArticle--short" data-post-id="bf2aa28d9b8a" data-source="responses---------2----------------" data-action-scope="_actionscope_12" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@suhasghorp" data-action="show-user-card" data-action-value="14e31690cede" data-action-type="hover" data-user-id="14e31690cede" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-pQuP8aWm-XBXWm-M" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Suhas Ghorpadkar"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@suhasghorp?source=responses---------2----------------" data-action="show-user-card" data-action-source="responses---------2----------------" data-action-value="14e31690cede" data-action-type="hover" data-user-id="14e31690cede" dir="auto">Suhas Ghorpadkar</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@suhasghorp/thanks-for-the-excellent-information-bf2aa28d9b8a?source=responses---------2----------------" data-action="open-post" data-action-value="https://medium.com/@suhasghorp/thanks-for-the-excellent-information-bf2aa28d9b8a?source=responses---------2----------------" data-action-source="preview-listing"><time datetime="2017-02-17T17:25:00.339Z">Feb 17</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="1 min read"></span></div></div></div></div></div><div class="js-inlineExpandBody"><a class="" href="https://medium.com/@suhasghorp/thanks-for-the-excellent-information-bf2aa28d9b8a?source=responses---------2----------------" data-action="expand-inline"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="adb3" id="adb3" class="graf graf--p graf--leading graf--trailing">Thanks for the excellent information. I had a question. How do you run the unit tests&nbsp;? I copied your dir structure to windows/pycharm toolset as that’s what we use to develop, I know I will need to move it to Linux to make use of “make”. Also, we use python 2.7 so I had to install mock module. Now I want to run the unittests so I tried</p></div></div></section></div></a></div><div class="postArticle-readMore"><button class="button button--smaller button--link u-baseColor--buttonNormal" data-action="expand-inline">Read more…</button></div><div class="u-clearfix u-paddingTop10"><div class="buttonSet buttonSet--withLabels u-floatLeft"><div class="buttonSet-inner"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="bf2aa28d9b8a" data-is-flush-left="true" data-is-compressed="true" data-source="listing"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/bf2aa28d9b8a" data-action-source="listing" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"></span></div></div></div><div class="buttonSet u-floatRight"><div class="buttonSet-inner"><a class="button button--chromeless u-baseColor--buttonNormal" href="https://medium.com/@suhasghorp/thanks-for-the-excellent-information-bf2aa28d9b8a?source=responses---------2----------------#--responses" data-action-source="responses---------2----------------">1 response</a><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/bf2aa28d9b8a"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackedPost postArticle--short" data-post-id="765799520f3d" data-source="responses---------2----------------" data-action-scope="_actionscope_13" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@ekampf" data-action="show-user-card" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/0-v8BpiR61oW-Psfqp(1).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Eran Kampf"></a></div><div class="postMetaInline postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@ekampf?source=responses---------2----------------" data-action="show-user-card" data-action-source="responses---------2----------------" data-action-value="df73cbdf7d31" data-action-type="hover" data-user-id="df73cbdf7d31" dir="auto">Eran Kampf</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@ekampf/hey-suhas-765799520f3d?source=responses---------2----------------" data-action="open-post" data-action-value="https://medium.com/@ekampf/hey-suhas-765799520f3d?source=responses---------2----------------" data-action-source="preview-listing"><time datetime="2017-02-18T19:27:02.390Z">Feb 18</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@ekampf/hey-suhas-765799520f3d?source=responses---------2----------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="a78d" id="a78d" class="graf graf--p graf--leading">Hey Suhas,</p><p name="858f" id="858f" class="graf graf--p graf-after--p">I’m assuming you copied the structure in my sample project at <span class="markup--anchor markup--p-anchor" data-action="open-inner-link" data-action-value="https://github.com/ekampf/PySpark-Boilerplate">https://github.com/ekampf/PySpark-Boilerplate</span></p><p name="ab8e" id="ab8e" class="graf graf--p graf-after--p">In order to manually run specific tests you need the&nbsp;<em class="markup--em markup--p-em">./src</em> and&nbsp;<em class="markup--em markup--p-em">./src/libs</em> folders to be in your PYTHONPATH.</p><p name="56b2" id="56b2" class="graf graf--p graf-after--p graf--trailing">In PyCharm just go to <em class="markup--em markup--p-em">Project Structure</em> under <em class="markup--em markup--p-em">settings</em> and add them both as source folders…</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="buttonSet buttonSet--withLabels u-floatLeft"><div class="buttonSet-inner"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="765799520f3d" data-is-flush-left="true" data-is-compressed="true" data-source="listing"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/765799520f3d" data-action-source="listing" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"></span></div></div></div><div class="buttonSet u-floatRight"><div class="buttonSet-inner"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/765799520f3d"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-readNext"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><div class="u-marginAuto u-maxWidth1000"><div class="js-postShareWidget u-foreground u-sm-hide u-fixed u-transition--fadeOut300" data-scroll="fixed" style="top: 150px;"><ul><li class="u-textAlignCenter"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="cb688ac4d20f" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-is-compressed="true" data-has-recommend-list="true" data-source="post_share_widget"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="sign-in-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/cb688ac4d20f" data-action-source="post_share_widget" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="cb688ac4d20f"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto" data-action="show-recommends" data-action-value="cb688ac4d20f">58</button></span></div></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/cb688ac4d20f"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></div><div class="u-fixed u-bottom0 u-sizeFullWidth u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link avatar avatar--roundedRectangle u-baseColor--link" href="https://developerzen.com/" title="Go to DeveloperZen" aria-label="Go to DeveloperZen" data-collection-slug="developerzen"><img src="./Best Practices Writing Production-Grade PySpark Jobs_files/1-Uws0y2pBZSsJsoMaHD2JqA(1).png" class="avatar-image avatar-image--smaller" alt="DeveloperZen"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> DeveloperZen</strong>, when you sign up for Medium. <a class="link link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> DeveloperZen</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><button class="button button--primary button--dark is-active u-noUserSelect button--withChrome u-accentColor--buttonDark u-uiTextSemibold u-textUppercase u-fontSize12 button--followCollection js-followCollectionButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-collection" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/collection/developerzen" data-action-source="sticky_footer_collection_follow"><span class="button-label  button-defaultState js-buttonLabel">Get updates</span><span class="button-label button-activeState">Get updates</span></button></div></div></div><div class="js-drawerContainer"></div><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #848585 !important;}
.u-accentColor--borderNormal {border-color: #848585 !important;}
.u-accentColor--borderDark {border-color: #717272 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #848585 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #848585 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #717272 !important;}
.u-accentColor--textNormal {color: #717272 !important;}
.u-accentColor--hoverTextNormal:hover {color: #717272 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #686868 !important;}
.u-accentColor--textDark {color: #686868 !important;}
.u-accentColor--backgroundLight {background-color: #848585 !important;}
.u-accentColor--backgroundNormal {background-color: #848585 !important;}
.u-accentColor--backgroundDark {background-color: #717272 !important;}
.u-accentColor--buttonDark {border-color: #717272 !important; color: #686868 !important;}
.u-accentColor--buttonDark:hover {border-color: #686868 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #717272 !important; fill: #717272 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #848585 !important; color: #717272 !important;}
.u-accentColor--buttonNormal:hover {border-color: #717272 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #848585 !important; fill: #848585 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #717272 !important; border-color: #717272 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #848585 !important; border-color: #848585 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #717272 !important;}.u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-tintSpectrum .u-baseColor--borderLight {border-color: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--borderNormal {border-color: #818282 !important;}
.u-tintSpectrum .u-baseColor--borderDark {border-color: #575959 !important;}
.u-tintSpectrum .u-baseColor--iconLight .svgIcon,.u-tintSpectrum .u-baseColor--iconLight.svgIcon {fill: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--iconNormal .svgIcon,.u-tintSpectrum .u-baseColor--iconNormal.svgIcon {fill: #818282 !important;}
.u-tintSpectrum .u-baseColor--iconDark .svgIcon,.u-tintSpectrum .u-baseColor--iconDark.svgIcon {fill: #575959 !important;}
.u-tintSpectrum .u-baseColor--textNormal {color: #818282 !important;}
.u-tintSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--textDark {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--textDarker {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--backgroundLight {background-color: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--backgroundNormal {background-color: #818282 !important;}
.u-tintSpectrum .u-baseColor--backgroundDark {background-color: #575959 !important;}
.u-tintSpectrum .u-baseColor--buttonLight {border-color: #A8A8A8 !important; color: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--buttonLight:hover {border-color: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--buttonLight .icon:before,.u-tintSpectrum .u-baseColor--buttonLight .svgIcon {color: #A8A8A8 !important; fill: #A8A8A8 !important;}
.u-tintSpectrum .u-baseColor--buttonDark {border-color: #575959 !important; color: #404242 !important;}
.u-tintSpectrum .u-baseColor--buttonDark:hover {border-color: #404242 !important;}
.u-tintSpectrum .u-baseColor--buttonDark .icon:before,.u-tintSpectrum .u-baseColor--buttonDark .svgIcon {color: #575959 !important; fill: #575959 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal {border-color: #818282 !important; color: #818282 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal:hover {border-color: #575959 !important;}
.u-tintSpectrum .u-baseColor--buttonNormal .icon:before,.u-tintSpectrum .u-baseColor--buttonNormal .svgIcon {color: #818282 !important; fill: #818282 !important;}
.u-tintSpectrum .u-baseColor--buttonDark.button--filled,.u-tintSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: #575959 !important; border-color: #575959 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-tintSpectrum .u-baseColor--buttonNormal.button--filled,.u-tintSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: #818282 !important; border-color: #818282 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-tintSpectrum .u-baseColor--link {color: #818282 !important;}
.u-tintSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--link.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--darken:active {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--link.link--dark {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:active {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--link.link--darker {color: #404242 !important;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: #A8A8A8;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: #A8A8A8;}
.u-tintSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: #A8A8A8;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: #DDDDDD !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: #CCCCCC !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: #A8A8A8 !important;}
.u-tintSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: #818282 !important;}
.u-tintSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: #404242 !important;}
.u-tintSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: #404242 !important;}
.u-tintSpectrum .u-accentColor--borderLight {border-color: #A8A8A8 !important;}
.u-tintSpectrum .u-accentColor--borderNormal {border-color: #818282 !important;}
.u-tintSpectrum .u-accentColor--borderDark {border-color: #575959 !important;}
.u-tintSpectrum .u-accentColor--iconLight .svgIcon,.u-tintSpectrum .u-accentColor--iconLight.svgIcon {fill: #A8A8A8 !important;}
.u-tintSpectrum .u-accentColor--iconNormal .svgIcon,.u-tintSpectrum .u-accentColor--iconNormal.svgIcon {fill: #818282 !important;}
.u-tintSpectrum .u-accentColor--iconDark .svgIcon,.u-tintSpectrum .u-accentColor--iconDark.svgIcon {fill: #575959 !important;}
.u-tintSpectrum .u-accentColor--textNormal {color: #818282 !important;}
.u-tintSpectrum .u-accentColor--hoverTextNormal:hover {color: #818282 !important;}
.u-tintSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #404242 !important;}
.u-tintSpectrum .u-accentColor--textDark {color: #404242 !important;}
.u-tintSpectrum .u-accentColor--backgroundLight {background-color: #A8A8A8 !important;}
.u-tintSpectrum .u-accentColor--backgroundNormal {background-color: #818282 !important;}
.u-tintSpectrum .u-accentColor--backgroundDark {background-color: #575959 !important;}
.u-tintSpectrum .u-accentColor--buttonDark {border-color: #575959 !important; color: #404242 !important;}
.u-tintSpectrum .u-accentColor--buttonDark:hover {border-color: #404242 !important;}
.u-tintSpectrum .u-accentColor--buttonDark .icon:before,.u-tintSpectrum .u-accentColor--buttonDark .svgIcon{color: #575959 !important; fill: #575959 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #818282 !important; color: #818282 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:hover {border-color: #575959 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal .svgIcon{color: #818282 !important; fill: #818282 !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonDark.button--filled,.u-tintSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-tintSpectrum .u-accentColor--fillWhenActive.is-active {background-color: #575959 !important; border-color: #575959 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-tintSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #818282 !important; border-color: #818282 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-tintSpectrum .postArticle.is-withAccentColors .markup--user,.u-tintSpectrum .postArticle.is-withAccentColors .markup--query {color: #818282 !important;}
.u-accentColor--highlightFaint {background-color: rgba(242, 240, 240, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(224, 223, 223, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(242, 240, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(242, 240, 240, 1), rgba(242, 240, 240, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(232, 231, 231, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(232, 231, 231, 1), rgba(232, 231, 231, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(224, 223, 223, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(224, 223, 223, 1), rgba(224, 223, 223, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(224, 223, 223, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(224, 223, 223, 1), rgba(224, 223, 223, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(224, 223, 223, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(224, 223, 223, 1), rgba(224, 223, 223, 1));}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(255, 255, 255, 0.4) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(255, 255, 255, 0.4980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(0, 0, 0, 0.4) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-in-prompt" data-sign-in-action="quote" data-requires-token="true" data-skip-onboarding="true" data-redirect-type="quote" data-action-source="quote_menu"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="quote-respond" data-skip-onboarding="true" data-action-source="quote_menu"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="twitter" data-action-source="quote_menu"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="highlight" data-skip-onboarding="true" data-action-source="quote_menu"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://developerzen.com","buildLabel":"30541-bff57c4","currentUser":{"userId":"lo_71fae15c7cc6","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.Se1zoDtn8Cd4GEtzG-aimQ.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.SjiHW9CCfniQYys-uQGSAQ.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.mBQdIkr0V2xnO5daMzD6lQ.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.JzQAWFZGBw147r2EzLr7xg.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.twIz5a4MPpm_WvMhjxAiDg.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.IyueCrgDhtn-YjbqMRhQfw.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.-a077mAC4olTd-y0hD7lIA.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.NVbZMx2AoEUjrchepExccQ.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1505091773813:63bf4b917cb2","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":60,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":false,"emojiSupportLevel":5,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"enable_onboarding":true,"ios_custom_miro_url":"https://cdn-images-1.medium.com","reengagement_notification_duration":3,"enable_adsnative_integration":true,"browsable_stream_config_bucket":"curated-topics","ios_small_post_preview_truncation_length":5.5,"ios_large_post_preview_truncation_length":5.5,"disable_ios_catalog_badging":true,"enable_series_creation":true,"enable_your_series_pages":true,"enable_productionized_series":true,"enable_dedicated_series_tab_api_ios":true,"enable_clap_milestone_notifications":true,"enable_series_stats_page":true,"enable_direct_auth_connect":true,"enable_post_import":true,"enable_sponsored_post_labelling":true,"enable_logged_in_follow_on_collection_post":true,"promoted_story_placement_locations":"POST_PAGE_FOOTER","enable_chunky_home_page":true,"enable_sms_app_promo":true,"enable_export_members":true,"enable_series_card_background_creation":true,"available_membership_plans":"60e220181034","available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","double_write_post_from_followed_tag_items":true,"enable_sms":true,"enable_series_in_user_profiles":true,"enable_new_logged_out_bento_operation":true,"is_not_medium_subscriber":true,"subs_landing_copy_experiments":"short","logged_out_homepage_promo":"content","daily_digest_topics":true,"enable_emoji_in_editor":true,"glyph_font_set":"m","enable_branding":true,"enable_upsell_tracking":true,"enable_post_page_signin":true,"post_page_signin_copy_count":true,"enable_sequence_carousel":true,"enable_multirecommends":true,"enable_updated_homepage_order":true,"enable_auto_grid_on_new_from_your_network":true,"enable_unbundled_you_might_like":true,"enable_noteworthy_promo":true,"enable_popchunks":true,"enable_hightower":true,"enable_user_post_metering":true,"max_premium_content_per_user_under_metering":3,"enable_evergreen_in_topic_popchunks":true,"enable_hightower_onboarding_blinker":true,"enable_direct_signin":true,"enable_strong_graph_chp_reorder":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/favicon.svg":"https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":false,"domainCollectionSlug":"developerzen","algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*W0nmth_X8nFKjn6BZ388UQ.png","fontSets":[{"id":1,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"},{"id":4,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-base.g08Jj5TZPAiuPWj5YNUsSg.css"},{"id":6,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-latin-base.141WxxXgxGxNcfeza73H7Q.css"},{"id":7,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-latin-base.jMU532QDmysQMOINr-cr2A.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"78a5dd6d1c9ced37\",\"ot-tracer-traceid\":\"07cb3b7a4c641fce\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"mailingListArchiveUploadSizeMb":2,"availableMembershipPlans":["60e220181034"],"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com","accessToken":"pJN6XGc43dDJLHJQ2ixamOFHUnAgKvhp"}}
// ]]></script><script charset="UTF-8" src="./Best Practices Writing Production-Grade PySpark Jobs_files/main-base.bundle.Se1zoDtn8Cd4GEtzG-aimQ.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"cb688ac4d20f","versionId":"4c41a5a15fe3","creatorId":"df73cbdf7d31","creator":{"userId":"df73cbdf7d31","name":"Eran Kampf","username":"ekampf","createdAt":1382608501701,"lastPostCreatedAt":1502904561923,"imageId":"0*v8BpiR61oW-Psfqp.jpeg","backgroundImageId":"1*wBeRnCrmM28xVes_SBpicA.png","bio":"Maker of things. Big data geek. Onavo, Snaptu, WIX, WonderMall, Labgoo … Founder and CTO of dapulse.com and fiddme.","twitterScreenName":"ekampf","socialStats":{"userId":"df73cbdf7d31","usersFollowedCount":616,"usersFollowedByCount":846,"type":"SocialStats"},"social":{"userId":"lo_71fae15c7cc6","targetUserId":"df73cbdf7d31","type":"Social"},"facebookAccountId":"10153829056591494","allowNotes":1,"type":"User"},"homeCollection":{"id":"d186b3e1d814","name":"DeveloperZen","slug":"developerzen","tags":["SOFTWARE ENGINEERING","ENGINEERING MANAGEMENT","BIG DATA","DATA SCIENCE"],"creatorId":"df73cbdf7d31","description":"The essence of Software Development …","shortDescription":"The essence of Software Development …","image":{"imageId":"1*Uws0y2pBZSsJsoMaHD2JqA.png","filter":"","backgroundSize":"","originalWidth":60,"originalHeight":60,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":44,"activeAt":1493355788885},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0VW1-pnCJTT6h10pfaBgHQ.png","filter":"","backgroundSize":"","originalWidth":387,"originalHeight":57,"strategy":"resample","height":0,"width":0},"twitterUsername":"ekampf","facebookPageName":"ekampf","publicEmail":"eran@ekampf.com","domain":"developerzen.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}}],"tintColor":"#FFFFFFFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF848585","point":0},{"color":"#FF7B7B7B","point":0.1},{"color":"#FF717272","point":0.2},{"color":"#FF686868","point":0.3},{"color":"#FF5E5E5E","point":0.4},{"color":"#FF545454","point":0.5},{"color":"#FF494A4A","point":0.6},{"color":"#FF3F3F3F","point":0.7},{"color":"#FF333333","point":0.8},{"color":"#FF272727","point":0.9},{"color":"#FF1A1A1A","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFEEEEEE","point":0.1},{"color":"#FFDDDDDD","point":0.2},{"color":"#FFCCCCCC","point":0.3},{"color":"#FFBABABB","point":0.4},{"color":"#FFA8A8A8","point":0.5},{"color":"#FF959696","point":0.6},{"color":"#FF818282","point":0.7},{"color":"#FF6D6E6E","point":0.8},{"color":"#FF575959","point":0.9},{"color":"#FF404242","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF4F2F2","point":0},{"color":"#FFF2F0F0","point":0.1},{"color":"#FFF0EEEE","point":0.2},{"color":"#FFEEECEC","point":0.3},{"color":"#FFECEBEA","point":0.4},{"color":"#FFEAE9E8","point":0.5},{"color":"#FFE8E7E7","point":0.6},{"color":"#FFE6E5E5","point":0.7},{"color":"#FFE4E3E3","point":0.8},{"color":"#FFE2E1E1","point":0.9},{"color":"#FFE0DFDF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"googleAnalyticsId":"UA-209163-4","ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5},"type":"Collection"},"homeCollectionId":"d186b3e1d814","title":"Best Practices Writing Production-Grade PySpark Jobs","detectedLanguage":"en","latestVersion":"4c41a5a15fe3","latestPublishedVersion":"4c41a5a15fe3","hasUnpublishedEdits":false,"latestRev":2159,"createdAt":1484351419346,"updatedAt":1504815684910,"acceptedAt":0,"firstPublishedAt":1485281273616,"latestPublishedAt":1497913484967,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"How to Structure Your PySpark Job Repository and Code","bodyModel":{"paragraphs":[{"name":"e584","type":3,"text":"Best Practices Writing Production-Grade PySpark Jobs","markups":[]},{"name":"cc3b","type":13,"text":"How to Structure Your PySpark Job Repository and Code","markups":[]},{"name":"68bd","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*d3-v-8IrgJJHaKefzo3eXA.jpeg","originalWidth":1500,"originalHeight":809}},{"name":"941c","type":1,"text":"Using PySpark to process large amounts of data in a distributed fashion is a great way to manage large-scale data-heavy tasks and gain business insights while not sacrificing on developer efficiency.","markups":[]},{"name":"5a14","type":1,"text":"In short, PySpark is awesome.\nHowever, while there are a lot of code examples out there, there’s isn’t a lot of information out there (that I could find) on how to build a PySpark codebase— writing modular jobs, building, packaging, handling dependencies, testing, etc. — that could scale to a larger development team.","markups":[{"type":3,"start":10,"end":17,"href":"http://spark.apache.org/docs/latest/api/python/","title":"","rel":"noopener","anchorType":0}]},{"name":"ace8","type":1,"text":"So, following a year+ working with PySpark I decided to collect all the know-hows and conventions we’ve gathered into this post (and accompanying boilerplate project)","markups":[{"type":3,"start":146,"end":165,"href":"https://github.com/ekampf/PySpark-Boilerplate","title":"","rel":"","anchorType":0}]},{"name":"1942","type":1,"text":"In this post we’ll cover:","markups":[]},{"name":"c1c9","type":9,"text":"Structuring PySpark Jobs","markups":[]},{"name":"eafd","type":9,"text":"Handling 3rd-party dependencies","markups":[]},{"name":"f7f7","type":9,"text":"Writing a PySpark Job","markups":[]},{"name":"9f1f","type":9,"text":"Unit Testing","markups":[]},{"name":"d198","type":3,"text":"Structuring our Jobs Repository","markups":[]},{"name":"4e2f","type":1,"text":"First, let’s go over how submitting a job to PySpark works:\nspark-submit --py-files pyfile.py,zipfile.zip main.py --arg1 val1","markups":[{"type":10,"start":60,"end":125}]},{"name":"5db1","type":1,"text":"When we submit a job to PySpark we submit the main Python file to run — main.py — and we can also add a list of dependent files that will be located together with our main file during execution.\nThese dependency files can be .py code files we can import from, but can also be any other kind of files. For example, .zip packages.","markups":[{"type":10,"start":72,"end":79},{"type":2,"start":225,"end":228},{"type":2,"start":314,"end":318}]},{"name":"b6b4","type":1,"text":"One of the cool features in Python is that it can treat a zip file as a directory as import modules and functions from just as any other directory. \nAll that is needed is to add the zip file to its search path.","markups":[{"type":2,"start":58,"end":61},{"type":2,"start":182,"end":185}]},{"name":"b80f","type":8,"text":"import sys\nsys.path.insert(0, jobs.zip)","markups":[]},{"name":"4656","type":1,"text":"now (assuming jobs.zip contains a python module called jobs) we can import that module and whatever that’s in it. For example:","markups":[{"type":2,"start":14,"end":22},{"type":2,"start":55,"end":59}]},{"name":"f90d","type":8,"text":"from jobs.wordcount import run_job\nrun_job()","markups":[]},{"name":"1262","type":1,"text":"This will allow us to build our PySpark job like we’d build any Python project — using multiple modules and files — rather than one bigass myjob.py (or several such files)","markups":[{"type":2,"start":139,"end":147}]},{"name":"c2c9","type":1,"text":"Armed with this knowledge let’s structure out PySpark project…","markups":[]},{"name":"612c","type":13,"text":"Jobs as Modules","markups":[]},{"name":"d1d4","type":1,"text":"We’ll define each job as a Python module where it can define its code and transformation in whatever way it likes (multiple files, multiple sub modules…).","markups":[]},{"name":"fafc","type":8,"text":".\n├── README.md\n├── src\n│   ├── main.py\n│   ├── jobs\n│   │   └── wordcount\n│   │       └── __init__.py","markups":[]},{"name":"e425","type":1,"text":"The job itself has to expose an analyze function:","markups":[{"type":10,"start":32,"end":39}]},{"name":"61c5","type":8,"text":"def analyze(sc, **kwargs):\n   ...","markups":[]},{"name":"f4ce","type":1,"text":"and a main.py which is the entry point to our job — it parses command line arguments and dynamically loads the requested job module and runs it:","markups":[{"type":10,"start":6,"end":13}]},{"name":"717a","type":8,"text":"import pyspark","markups":[]},{"name":"a922","type":8,"text":"if os.path.exists('jobs.zip'):\n    sys.path.insert(0, 'jobs.zip')\nelse:\n    sys.path.insert(0, './jobs')","markups":[]},{"name":"996d","type":8,"text":"parser = argparse.ArgumentParser()\nparser.add_argument('--job', type=str, required=True)\nparser.add_argument('--job-args', nargs='*')\nargs = parser.parse_args()","markups":[]},{"name":"9d28","type":8,"text":"sc = pyspark.SparkContext(appName=args.job_name)\njob_module = importlib.import_module('jobs.%s' % args.job)\njob_module.analyze(sc, job_args)","markups":[]},{"name":"9d38","type":1,"text":"To run this job on Spark we’ll need to package it so we can submit it via spark-submit …","markups":[{"type":10,"start":74,"end":86}]},{"name":"5ce2","type":3,"text":"Packaging","markups":[]},{"name":"89aa","type":1,"text":"As we previously showed, when we submit the job to Spark we want to submit main.py as our job file and the rest of the code as a --py-files extra dependency jobs.zipfile.\nSo, out packaging script (we’ll add it as a command to our Makefile) is:","markups":[{"type":10,"start":75,"end":82},{"type":10,"start":129,"end":139},{"type":10,"start":157,"end":165},{"type":10,"start":230,"end":238}]},{"name":"0cc6","type":8,"text":"build:\n    mkdir ./dist\n    cp ./src/main.py ./dist\n    cd ./src && zip -x main.py -r ../dist/jobs.zip .","markups":[]},{"name":"b0ad","type":1,"text":"Now we can submit our job to Spark:","markups":[]},{"name":"acaa","type":8,"text":"make build\ncd dist && spark-submit --py-files jobs.zip main.py --job wordcount","markups":[]},{"name":"68f8","type":1,"text":"If you noticed before, out main.py code runs \nsys.path.insert(0, 'jobs.zip)\nmaking all the modules inside it available for import.\nRight now we only have one such module we need to import — jobs — which contains our job logic.","markups":[{"type":10,"start":27,"end":34},{"type":10,"start":46,"end":75},{"type":10,"start":190,"end":194}]},{"name":"fd96","type":1,"text":"We can also add a shared module for writing logic that is used by multiple jobs. That module we’ll simply get zipped into jobs.zip too and become available for import.","markups":[{"type":10,"start":18,"end":24},{"type":10,"start":122,"end":130}]},{"name":"556f","type":8,"text":".\n├── Makefile\n├── README.md\n├── src\n│   ├── main.py\n│   ├── jobs\n│   │   └── wordcount\n│   │       └── __init__.py\n│   └── shared\n│       └── __init__.py","markups":[]},{"name":"01b4","type":13,"text":"Handling 3rd Party Dependencies","markups":[]},{"name":"aaa9","type":1,"text":"One of the requirements anyone who’s writing a job bigger the the “hello world” probably needs to depend on some external python pip packages.","markups":[]},{"name":"d80c","type":1,"text":"To use external libraries, we’ll simply have to pack their code and ship it to spark the same way we pack and ship our jobs code. \npip allows installing dependencies into a folder using its -t ./some_folder options.","markups":[{"type":10,"start":131,"end":134},{"type":10,"start":190,"end":206}]},{"name":"bd51","type":1,"text":"The same way we defined the shared module we can simply install all our dependencies into the src folder and they’ll be packages and be available for import the same way our jobs and shared modules are:","markups":[{"type":10,"start":28,"end":34},{"type":10,"start":94,"end":97},{"type":10,"start":174,"end":178},{"type":10,"start":183,"end":189}]},{"name":"db6b","type":8,"text":"pip install -r requirements.txt -t ./src","markups":[]},{"name":"a22a","type":1,"text":"However, this will create an ugly folder structure where all our requirement’s code will sit in source, overshadowing the 2 modules we really care about: shared and jobs","markups":[{"type":10,"start":154,"end":160},{"type":10,"start":165,"end":169},{"type":2,"start":135,"end":141}]},{"name":"c0bb","type":1,"text":"That’s why I find it useful to add a special folder — libs — where I install requirements to:","markups":[{"type":10,"start":54,"end":58}]},{"name":"0ada","type":8,"text":".\n├── Makefile\n├── README.md\n├── requirements.txt\n├── src\n│   ├── main.py\n│   ├── jobs\n│   │   └── wordcount\n│   │       └── __init__.py\n│   └── libs\n│   │   └── requests\n│   │   └── ...\n│   └── shared\n│       └── __init__.py","markups":[{"type":1,"start":137,"end":186}]},{"name":"1106","type":1,"text":"With our current packaging system will break imports as import some_package will now have to be written as import libs.some_package.\nTo solve that we’ll simply package our libs folder into a separate zip package who’s root older is libs.","markups":[{"type":10,"start":56,"end":75},{"type":10,"start":107,"end":133},{"type":10,"start":172,"end":176},{"type":10,"start":232,"end":236}]},{"name":"9374","type":8,"text":"build: clean\n mkdir ./dist\n cp ./src/main.py ./dist\n cd ./src && zip -x main.py -x \\*libs\\* -r ../dist/jobs.zip .\n cd ./src/libs && zip -r ../../dist/libs.zip .","markups":[]},{"name":"9fb5","type":1,"text":"Now we can import our 3rd party dependencies without a libs. prefix, and run our job on PySpark using:","markups":[{"type":10,"start":55,"end":60}]},{"name":"44fb","type":8,"text":"cd dist\nspark-submit --py-files jobs.zip,libs.zip main.py --job wordcount","markups":[]},{"name":"dd25","type":1,"text":"The only caveat with this approach is that it can only work for pure-Python dependencies. For libraries that require C++ compilation, there’s no other choice but to make sure they’re pre-installed on all nodes before the job runs which is a bit harder to manage. Fortunately, most libraries do not require compilation which makes most dependencies easy to manage,","markups":[]},{"name":"0ed1","type":3,"text":"Writing a PySpark Job","markups":[]},{"name":"327c","type":1,"text":"The next section is how to write a jobs’s code so that it’s nice, tidy and easy to test.","markups":[]},{"name":"e03b","type":13,"text":"Providing a Shared Context","markups":[]},{"name":"6cfe","type":1,"text":"When writing a job, there’s usually some sort of global context we want to make available to the different transformation functions. \nSpark broadcast variables, counters, and misc configuration data coming from command-line are the common examples for such job context data.","markups":[{"type":2,"start":140,"end":170}]},{"name":"6ae8","type":1,"text":"For this case we’ll define a JobContext class that handles all our broadcast variables and counters:","markups":[{"type":10,"start":29,"end":39},{"type":2,"start":67,"end":86}]},{"name":"4c88","type":8,"text":"from collections import OrderedDict\nfrom tabulate import tabulate","markups":[]},{"name":"d44d","type":8,"text":"class JobContext(object):\n  def __init__(self, sc):\n    self.counters = OrderedDict()\n    self._init_accumulators(sc)\n    self._init_shared_data(sc)","markups":[]},{"name":"d41e","type":8,"text":"  def _init_accumulators(self, sc):\n    pass","markups":[]},{"name":"64a1","type":8,"text":"  def _init_shared_data(self, sc):\n    pass","markups":[]},{"name":"1abf","type":8,"text":"  def initalize_counter(self, sc, name):\n    self.counters[name] = sc.accumulator(0)","markups":[]},{"name":"2f68","type":8,"text":"  def inc_counter(self, name, value=1):\n    if name not in self.counters:\n      raise ValueError(\"%s counter was not initialized. (%s)\" % (name, self.counters.keys()))","markups":[]},{"name":"c115","type":8,"text":"    self.counters[name] += value","markups":[]},{"name":"0f09","type":8,"text":"  def print_accumulators(self):\n    print 'aa\\n' * 2\n    print tabulate(self.counters.items(), \n                   self.counters.keys(), \n                   tablefmt=\"simple\")","markups":[]},{"name":"2984","type":1,"text":"We’ll create an instance of it on our job’s code and pass it to our transformations.\nFor example, let’s say we want to test the number of words on our wordcount job:","markups":[]},{"name":"212d","type":8,"text":"class WordCountJobContext(JobContext):\n  def _init_accumulators(self, sc):\n    self.initalize_counter(sc, 'words')","markups":[]},{"name":"1231","type":8,"text":"def to_pairs(context, word):\n  context.inc_counter('words')\n  return word, 1","markups":[{"type":1,"start":31,"end":59}]},{"name":"e801","type":8,"text":"def analyze(sc):\n  print \"Running wordcount\"\n  context = WordCountJobContext(sc)\n  text = \" ...  some text ...\"","markups":[{"type":1,"start":47,"end":80}]},{"name":"f6f1","type":8,"text":"  words = sc.parallelize(text.split())\n  pairs = words.map(lambda word: to_pairs(context, word))\n  ordered = counts.sortBy(lambda pair: pair[1], ascending=False)\n  print ordered.collect()\n  context.print_accumulators()","markups":[{"type":1,"start":59,"end":95}]},{"name":"0ade","type":1,"text":"Besides sorting the words by occurrence, we’ll now also keep a distributed counter on our context that counts the number of words we processed in total. We can then nicely print it at the end by calling `context.print_accumulators()` or access it via context.counters['words']","markups":[{"type":10,"start":251,"end":276}]},{"name":"0679","type":13,"text":"Writing Transformations","markups":[]},{"name":"6f16","type":1,"text":"The code above is pretty cumbersome to write instead of simple transformations that look like pairs = words.map(to_pairs) we now have this extra context parameter requiring us to write a lambda expression: pairs = words.map(lambda word: to_pairs(context, word)","markups":[{"type":10,"start":94,"end":121},{"type":10,"start":206,"end":260}]},{"name":"992f","type":1,"text":"So we’ll use functools.partial to make our code nicer:","markups":[{"type":3,"start":13,"end":30,"href":"https://docs.python.org/2/library/functools.html#functools.partial","title":"","rel":"","anchorType":0},{"type":2,"start":13,"end":31}]},{"name":"387e","type":8,"text":"def analyze(sc):\n  print \"Running wordcount\"\n  context = WordCountJobContext(sc)\n  text = \" ...  some text ...\"","markups":[{"type":1,"start":47,"end":80}]},{"name":"dd45","type":8,"text":"  to_pairs_step = partial(to_pairs, context)","markups":[{"type":1,"start":2,"end":44}]},{"name":"aceb","type":8,"text":"  words = sc.parallelize(text.split())\n  pairs = words.map(to_pairs_step)\n  ordered = counts.sortBy(lambda pair: pair[1], ascending=False)\n  print ordered.collect()\n  context.print_accumulators()","markups":[{"type":1,"start":59,"end":72}]},{"name":"5cbe","type":3,"text":"Unit Testing","markups":[]},{"name":"410c","type":1,"text":"When looking at PySpark ode, there are few ways we can (should) test our code:","markups":[]},{"name":"4067","type":1,"text":"Transformation Tests — since transformations (like our to_pairs above) are just regular Python functions, we can simply test them the same way we’d test any other python Function","markups":[{"type":10,"start":55,"end":63},{"type":1,"start":0,"end":20}]},{"name":"7887","type":8,"text":"from mock import MagicMock\nfrom jobs.wordcount import to_pairs","markups":[]},{"name":"6b4f","type":8,"text":"def test_to_pairs():\n  context_mock = MagicMock()\n  result = to_pairs(context_mock, 'foo')\n  assert result[0] == 'foo'\n  assert result[1] == 1\n  context_mock.inc_counter.assert_called_with('words')","markups":[]},{"name":"ef8f","type":1,"text":"These tests cover 99% of our code, so if we just test our transformations we’re mostly covered.","markups":[]},{"name":"b4f2","type":1,"text":"Entire Flow Tests — testing the entire PySpark flow is a bit tricky because Spark runs in JAVA and as a separate process.\nThe best way to test the flow is to fake the spark functionality.\nThe PySparking is a pure-Python implementation of the PySpark RDD interface. \nIt acts like a real Spark cluster would, but implemented Python so we can simple send our job’s analyze function a pysparking.Contextinstead of the real SparkContext to make our job run the same way it would run in Spark.\nSince we’re running on pure Python we can easily mock things like external http requests, DB access etc. which is necessary for writing good unit tests.","markups":[{"type":10,"start":362,"end":369},{"type":10,"start":381,"end":399},{"type":10,"start":419,"end":431},{"type":3,"start":192,"end":202,"href":"https://github.com/svenkreiss/pysparkling","title":"","rel":"","anchorType":0},{"type":1,"start":0,"end":20},{"type":2,"start":158,"end":162}]},{"name":"02c0","type":8,"text":"import pysparkling\nfrom mock import patch\nfrom jobs.wordcount import analyze","markups":[]},{"name":"bd34","type":8,"text":"@patch('jobs.wordcount.get_text')\ndef test_wordcount(get_text_mock):\n  get_text_mock.return_value = \"foo bar foo\"\n  sc = pysparkling.Context()\n  result = analyze(sc)\n  assert result[0] == ('foo', 2)\n  assert result[1] == ('bar', 1)","markups":[]},{"name":"74a9","type":1,"text":"Testing the entire job flow requires refactoring the job’s code a bit so that analyze returns a value to be tested and that the input is configurable so that we could mock it.","markups":[{"type":10,"start":78,"end":85}]},{"name":"9885","type":3,"text":"Where to go from here…","markups":[]},{"name":"fdae","type":1,"text":"You can find the full source code for a PySpark starter boilerplate implementing the concepts described above on https://github.com/ekampf/PySpark-Boilerplate","markups":[{"type":3,"start":113,"end":158,"href":"https://github.com/ekampf/PySpark-Boilerplate","title":"","rel":"nofollow","anchorType":0}]}],"sections":[{"name":"b025","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"1*d3-v-8IrgJJHaKefzo3eXA.jpeg","filter":"","backgroundSize":"","originalWidth":1500,"originalHeight":809,"strategy":"resample","height":0,"width":0},"wordCount":1665,"imageCount":1,"readingTime":6.483018867924528,"subtitle":"How to Structure Your PySpark Job Repository and Code","publishedInCount":1,"usersBySocialRecommends":[],"recommends":43,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"python","name":"Python","postCount":7385,"virtuals":{"isFollowing":false},"metadata":{"followerCount":8435,"postCount":7385,"coverImage":{"id":"0*yVD6mleQs8wfhXjb.png","originalWidth":408,"originalHeight":272,"isFeatured":true}},"type":"Tag"},{"slug":"apache-spark","name":"Apache Spark","postCount":366,"virtuals":{"isFollowing":false},"metadata":{"followerCount":502,"postCount":366,"coverImage":{"id":"1*niTwIVb3IOYEOuRVBe5NrA.png","originalWidth":1512,"originalHeight":326,"isFeatured":true}},"type":"Tag"},{"slug":"machine-learning","name":"Machine Learning","postCount":19066,"virtuals":{"isFollowing":false},"metadata":{"followerCount":22316,"postCount":19066,"coverImage":{"id":"1*D_U4KwdLRPZbIOGc1I6-_A.png","originalWidth":855,"originalHeight":269}},"type":"Tag"},{"slug":"programming","name":"Programming","postCount":43015,"virtuals":{"isFollowing":false},"metadata":{"followerCount":46540,"postCount":43015,"coverImage":{"id":"1*vw_IFvZU5MVVb2-ZKiVvjA.png","originalWidth":1920,"originalHeight":1080,"isFeatured":true}},"type":"Tag"},{"slug":"software-development","name":"Software Development","postCount":25695,"virtuals":{"isFollowing":false},"metadata":{"followerCount":23185,"postCount":25695,"coverImage":{"id":"1*Y0UYuGcFGSCfs5Eexafq6A.png","originalWidth":1200,"originalHeight":653}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":4,"links":{"entries":[{"url":"https://docs.python.org/2/library/functools.html#functools.partial","alts":[],"httpStatus":200},{"url":"https://github.com/svenkreiss/pysparkling","alts":[],"httpStatus":200},{"url":"https://github.com/ekampf/PySpark-Boilerplate","alts":[],"httpStatus":200},{"url":"http://spark.apache.org/docs/latest/api/python/","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1497913488239},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":58,"sectionCount":1},"coverless":true,"slug":"best-practices-writing-production-grade-pyspark-jobs","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f","previewContent":{"bodyModel":{"paragraphs":[{"name":"e584","type":3,"text":"Best Practices Writing Production-Grade PySpark Jobs","markups":[],"alignment":1},{"name":"cc3b","type":13,"text":"How to Structure Your PySpark Job Repository and Code","markups":[],"alignment":1},{"name":"68bd","type":4,"text":"","markups":[],"layout":9,"metadata":{"id":"1*d3-v-8IrgJJHaKefzo3eXA.jpeg","originalWidth":1500,"originalHeight":809}}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f","approvedHomeCollectionId":"d186b3e1d814","approvedHomeCollection":{"id":"d186b3e1d814","name":"DeveloperZen","slug":"developerzen","tags":["SOFTWARE ENGINEERING","ENGINEERING MANAGEMENT","BIG DATA","DATA SCIENCE"],"creatorId":"df73cbdf7d31","description":"The essence of Software Development …","shortDescription":"The essence of Software Development …","image":{"imageId":"1*Uws0y2pBZSsJsoMaHD2JqA.png","filter":"","backgroundSize":"","originalWidth":60,"originalHeight":60,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":44,"activeAt":1493355788885},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0VW1-pnCJTT6h10pfaBgHQ.png","filter":"","backgroundSize":"","originalWidth":387,"originalHeight":57,"strategy":"resample","height":0,"width":0},"twitterUsername":"ekampf","facebookPageName":"ekampf","publicEmail":"eran@ekampf.com","domain":"developerzen.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}}],"tintColor":"#FFFFFFFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF848585","point":0},{"color":"#FF7B7B7B","point":0.1},{"color":"#FF717272","point":0.2},{"color":"#FF686868","point":0.3},{"color":"#FF5E5E5E","point":0.4},{"color":"#FF545454","point":0.5},{"color":"#FF494A4A","point":0.6},{"color":"#FF3F3F3F","point":0.7},{"color":"#FF333333","point":0.8},{"color":"#FF272727","point":0.9},{"color":"#FF1A1A1A","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFEEEEEE","point":0.1},{"color":"#FFDDDDDD","point":0.2},{"color":"#FFCCCCCC","point":0.3},{"color":"#FFBABABB","point":0.4},{"color":"#FFA8A8A8","point":0.5},{"color":"#FF959696","point":0.6},{"color":"#FF818282","point":0.7},{"color":"#FF6D6E6E","point":0.8},{"color":"#FF575959","point":0.9},{"color":"#FF404242","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF4F2F2","point":0},{"color":"#FFF2F0F0","point":0.1},{"color":"#FFF0EEEE","point":0.2},{"color":"#FFEEECEC","point":0.3},{"color":"#FFECEBEA","point":0.4},{"color":"#FFEAE9E8","point":0.5},{"color":"#FFE8E7E7","point":0.6},{"color":"#FFE6E5E5","point":0.7},{"color":"#FFE4E3E3","point":0.8},{"color":"#FFE2E1E1","point":0.9},{"color":"#FFE0DFDF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"googleAnalyticsId":"UA-209163-4","ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f","mediumUrl":"https://developerzen.com/best-practices-writing-production-grade-pyspark-jobs-cb688ac4d20f","migrationId":"","notifyFollowers":true,"notifyTwitter":true,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":true,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"df73cbdf7d31":{"userId":"df73cbdf7d31","name":"Eran Kampf","username":"ekampf","createdAt":1382608501701,"lastPostCreatedAt":1502904561923,"imageId":"0*v8BpiR61oW-Psfqp.jpeg","backgroundImageId":"1*wBeRnCrmM28xVes_SBpicA.png","bio":"Maker of things. Big data geek. Onavo, Snaptu, WIX, WonderMall, Labgoo … Founder and CTO of dapulse.com and fiddme.","twitterScreenName":"ekampf","socialStats":{"userId":"df73cbdf7d31","usersFollowedCount":616,"usersFollowedByCount":846,"type":"SocialStats"},"social":{"userId":"lo_71fae15c7cc6","targetUserId":"df73cbdf7d31","type":"Social"},"facebookAccountId":"10153829056591494","allowNotes":1,"type":"User"}},"Collection":{"d186b3e1d814":{"id":"d186b3e1d814","name":"DeveloperZen","slug":"developerzen","tags":["SOFTWARE ENGINEERING","ENGINEERING MANAGEMENT","BIG DATA","DATA SCIENCE"],"creatorId":"df73cbdf7d31","description":"The essence of Software Development …","shortDescription":"The essence of Software Development …","image":{"imageId":"1*Uws0y2pBZSsJsoMaHD2JqA.png","filter":"","backgroundSize":"","originalWidth":60,"originalHeight":60,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":44,"activeAt":1493355788885},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0VW1-pnCJTT6h10pfaBgHQ.png","filter":"","backgroundSize":"","originalWidth":387,"originalHeight":57,"strategy":"resample","height":0,"width":0},"twitterUsername":"ekampf","facebookPageName":"ekampf","publicEmail":"eran@ekampf.com","domain":"developerzen.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}}],"tintColor":"#FFFFFFFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF848585","point":0},{"color":"#FF7B7B7B","point":0.1},{"color":"#FF717272","point":0.2},{"color":"#FF686868","point":0.3},{"color":"#FF5E5E5E","point":0.4},{"color":"#FF545454","point":0.5},{"color":"#FF494A4A","point":0.6},{"color":"#FF3F3F3F","point":0.7},{"color":"#FF333333","point":0.8},{"color":"#FF272727","point":0.9},{"color":"#FF1A1A1A","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFEEEEEE","point":0.1},{"color":"#FFDDDDDD","point":0.2},{"color":"#FFCCCCCC","point":0.3},{"color":"#FFBABABB","point":0.4},{"color":"#FFA8A8A8","point":0.5},{"color":"#FF959696","point":0.6},{"color":"#FF818282","point":0.7},{"color":"#FF6D6E6E","point":0.8},{"color":"#FF575959","point":0.9},{"color":"#FF404242","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFF4F2F2","point":0},{"color":"#FFF2F0F0","point":0.1},{"color":"#FFF0EEEE","point":0.2},{"color":"#FFEEECEC","point":0.3},{"color":"#FFECEBEA","point":0.4},{"color":"#FFEAE9E8","point":0.5},{"color":"#FFE8E7E7","point":0.6},{"color":"#FFE6E5E5","point":0.7},{"color":"#FFE4E3E3","point":0.8},{"color":"#FFE2E1E1","point":0.9},{"color":"#FFE0DFDF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"googleAnalyticsId":"UA-209163-4","ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"DeveloperZen","description":"The essence of Software Development …","backgroundImage":{"id":"1*dmFyESBUHmoxyPOxDA5IlQ.jpeg","originalWidth":1920,"originalHeight":1280,"focusPercentX":68.57142857142857,"focusPercentY":49.19786096256684},"logoImage":{},"alignment":2,"layout":5},"type":"Collection"}},"Social":{"df73cbdf7d31":{"userId":"lo_71fae15c7cc6","targetUserId":"df73cbdf7d31","type":"Social"}},"SocialStats":{"df73cbdf7d31":{"userId":"df73cbdf7d31","usersFollowedCount":616,"usersFollowedByCount":846,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Best Practices Writing Production-Grade PySpark Jobs_files/main-common-async.bundle.twIz5a4MPpm_WvMhjxAiDg.js"></script><script charset="UTF-8" src="./Best Practices Writing Production-Grade PySpark Jobs_files/main-notes.bundle.SjiHW9CCfniQYys-uQGSAQ.js"></script></body></html>